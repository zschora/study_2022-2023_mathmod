---
## Front matter
title: "Отчет по групповому проекту. Этап 2."
subtitle: "Неравновесная агрегация, фракталы"
author:
  - Шалыгин Г. Э.
  - Низамова А. А.
  - Голощапова И. Б.
  - Серегин Д. А.
  - Пиняева А. А
institute:
  - Российский университет дружбы народов, Москва, Россия
date: 4 марта 2023

## Generic otions
lang: ru-RU
toc-title: "Содержание"

## Bibliography
bibliography: bib/cite.bib
csl: pandoc/csl/gost-r-7-0-5-2008-numeric.csl

## Pdf output format
toc: true # Table of contents
toc-depth: 2
lof: true # List of figures
lot: true # List of tables
fontsize: 12pt
linestretch: 1.5
papersize: a4
documentclass: scrreprt
## I18n polyglossia
polyglossia-lang:
  name: russian
  options:
	- spelling=modern
	- babelshorthands=true
polyglossia-otherlangs:
  name: english
## I18n babel
babel-lang: russian
babel-otherlangs: english
## Fonts
mainfont: PT Serif
romanfont: PT Serif
sansfont: PT Sans
monofont: PT Mono
mainfontoptions: Ligatures=TeX
romanfontoptions: Ligatures=TeX
sansfontoptions: Ligatures=TeX,Scale=MatchLowercase
monofontoptions: Scale=MatchLowercase,Scale=0.9
## Biblatex
biblatex: true
biblio-style: "gost-numeric"
biblatexoptions:
  - parentracker=true
  - backend=biber
  - hyperref=auto
  - language=auto
  - autolang=other*
  - citestyle=gost-numeric
## Pandoc-crossref LaTeX customization
figureTitle: "Рис."
tableTitle: "Таблица"
listingTitle: "Листинг"
lofTitle: "Список иллюстраций"
lotTitle: "Список таблиц"
lolTitle: "Листинги"
## Misc options
indent: true
header-includes:
  - \usepackage{indentfirst}
  - \usepackage{float} # keep figures where there are in the text
  - \floatplacement{figure}{H} # keep figures where there are in the text
  - \usepackage[ruled,vlined,linesnumbered]{algorithm2e}
---

# Цель работы

Цель:

- Изучить алгоритмы моделирования неравновесной агрегации.

Задачи:

- Рассмотреть методы используемые в построении алгоритмов неравновесной агрегации.
- Построить алгоритмы модели неравновесной агрегации.
- Построить алгоритм вычисления фрактальной размерности.

# Теоретическое введение

## Постановка задачи

Существуют разнообразные физические процессы, основная черта которых — неравновесная агрегация. Примеры: образование частиц сажи, рост осадков при электрическом осаждении и т. п. Во всех случаях происходит необратимое прилипание частиц к растущему кластеру из-за сильного смещения равновесия в сторону твердой фазы, и вырастают разветвленные агрегаты (рост правильных ограненных кристаллов происходит в условиях, близких к равновесным, когда возможно как прилипание частиц, так и их обратный переход в раствор)

## Случайные блуждания

### Одномерные случайные блуждания

Рассмотрим простую модель — пусть частицы могут двигаться только вдоль прямой, делая шаги случайной длины. Примем также, что величина и направление каждого шага определяются независимо от положения частицы и от предыдущих шагов (модель «пьяного моряка»). Будем наблюдать за частицей через равные промежутки времени. Координата частицы вычисляется по рекуррентной формуле $x_k = x_{k−1}+\delta_k$, где $\delta_k$ — очередной шаг блуждания. При отсутствии силового поля смещение влево и вправо равновероятны. В общем случае вероятность того, что длина шага лежит в промежутке от #\delta$ до $\delta+d\delta$, равна $dp = w(\delta)d\delta$. Функция w называется плотностью вероятности для величины шага δ, который называют случайной величиной. 

Подробнее в [@qq].

### Многомерные случайные блуждания

Предоставим теперь нашим частицам возможность двигаться также по координате y — рассмотрим двумерные случайные блуждания (случай трех измерений получается аналогично). Можно независимо задавать смещение по вертикали $\delta_y$ равномерно распределенным таким же образом, как и смещение по горизонтали $\delta_x$ .

Функция распределения в двумерном случае представляется в виде произведения двух функций распределения по координатам x и y , так как x и y являются независимыми случайными величинами. Подробнее в [@qq].

## Фрактальная размерность

Фигура на плоскости или тело в пространстве имеют размерность. Определить ее можно разными способами. В случае, когда у фигуры есть выделенная центральная точка, можно построить много сфер различного радиуса с центром в этой точке. Для каждой сферы можно вычислить массу части фигуры, которая оказалась внутри этой сферы. В случае, когда масса пропорциональна радиусу сферы в некоторой степени ($m \sim R^D$), показатель степени D называется размерностью тела. Это так называемый метод сфер или ящиков. Для линий D = 1, у плоских фигур D = 2, у «обычных» тел D = 3. Однако, многие объекты в природе имеют размерность, выражающуюся дробным числом.

Такие тела, следуя Б. Мандельброту [9], называют фракталами (от латинского слова fractus — дробный). Фракталами являются также дендриты, вырастающие при электроосаждении металлов, кластеры, полученные при агрегации коллоидов; фрактальную структуру имеют ветви деревьев, кровеносная система и т. п.

Еще один способ может применяться при наблюдении за процессом роста агрегата от центра. В этом случае число частиц в кластере $N \sim R^D_{ch}$. В качестве характерного радиуса Rch можно выбирать, например, максимальный радиус кластера $R_{max}$,

Желающим более подробно познакомиться с фракталами рекомендуем книгу [@ww].



# Математические модели

## Агрегация, ограниченная диффузией

### Сеточная модель.

Возьмем регулярную сетку на плоскости, например, квадратную. В центр поместим затравочную частицу. Затем с достаточно большого расстояния будем выпускать по одной новые частицы. Выпущенная частица совершает случайные блуждания по сетке, делая шаги в одном из четырех доступных направлений с равной вероятностью. Если частица оказывается по соседству с затравкой, она прилипает и остается в этом узле. Затем выпускаем следующую частицу, которая может прилипнуть к одному из занятых узлов. Шаг решетки в этой модели соответствует длине связи между частицами (расстоянию устойчивого равновесия для взаимодействия двух частиц).

*Некоторые указания.* Для ускорения работы программы разумно выпускать частицы с круга радиусом немного больше Rmax — текущего максимального радиуса агрегата.

Если частица уходит далеко, уничтожаем ее и выпускаем новую.

### Бессеточная модель.

Структура полученных DLA-кластеров отражает структуру сетки (имеются выделенные направления). Чтобы получить более симметричные кластеры, можно отказаться от сетки. В этом случае рост происходит следующим образом: вначале помещаем в центр поля затравочную частицу, затем с круга некоторого радиуса выпускаем следующую, которая случайно блуждает. Если частицы сближаются на расстояние взаимодействия (например, их удвоенный радиус), они слипаются. После этого выпускаем новую частицу и т. д.

Детальная информация в [@mod]

### Химически-ограниченная агрегация

При диффузионно-ограниченной агрегации частица всегда прилипает к кластеру с вероятностью 1. Можно уменьшить вероятность прилипания. Такой процесс роста называется химически-ограниченной агрегацией. Он моделирует ситуацию, когда вероятность зависит от того, каким концом молекула повернута к другой. Это приведет к появлению более плотных агрегатов (увеличению размерности), потому что у частицы увеличится шанс проникать во внутренние области и заполнять пустоты. Размерность, однако, остается меньше размерности пространства, т. е. кластер остается фракталом.

### Баллистическая агрегация

До сих пор мы рассматривали рост кластеров с точечной затравки. Однако, довольно часто встречаются ситуации, когда агрегаты растут на поверхности, например, при выпадении осадка на дне или стенках сосуда. Если новые частицы доставляются к растущему кластеру за счет диффузии, имеем просто модель DLA с измененными начальными условиями.

Другой случай — *баллистическая агрегация*, при которой частицы свободно падают по прямолинейным траекториям. Частица прилипает, когда оказывается рядом с занятым узлом. В этом процессе получается более плотный агрегат (но не сплошной), однако его граница сильно изрезана и является фракталом.

# Алгоритмы

## Используемые методы

### Теоретическое введение в генерацию псевдослучайных чисел

Джон фон Нейман считал неприемлемым использование физических генераторов случайных чисел в вычислительной технике, так как при возникновении необходимости проверки вычислений повтор предыдущих действий требовал бы воспроизведение случайного числа, в то время как генерация нового случайного числа недопустима. Предварительная запись и хранение сгенерированных случайных чисел предполагало бы возможность их считывания. Механизм считывания данных являлся одним из самых слабых звеньев вычислительных машин 1940-х годов. Джон фон Нейман привёл следующий метод «середины квадрата» получения десятизначных псевдослучайных чисел: 

*Десятизначное число возводится в квадрат, затем из середины квадрата числа берётся десятизначное число, которое снова возводится в квадрат, и так далее.*

В 1951 году Д. Г. Лемерпредложил линейный конгруэнтный метод:

- Алгоритм, порождающий последовательность чисел, элементы которой почти независимы друг от друга и подчиняются заданному распределению (обычно дискретному равномерному).
- Линейный когруэнтный метод:
  1. Начальные условия: $m$ -- достаточно большое натуральное число, $a$ -- множитель, $c$ -- приращение, $X_0$ -- начальное значение.
  2. Возвращаемые значения: последовательность $X_1, X_2, ...$ 
  3. Последовательность описывается формулой:  $$X_{n+1} = (a\cdot X_n + c) \mod m$$

Линейная конгруэнтная последовательность, определенная числами $m, a, c, X_0$ периодична с периодом, не превышающим $m$. При этом длина периода равна $m$ тогда и только тогда, когда:

1. Числа $c, m$ взаимно простые
2. $p|(a-1)\ \  \forall\ p | m$
3. $4|m \implies 4|(a-1)$

Подробнее в [@rr].

## Алгоритмы для DLA	

### Генерация псевдослучайных чисел

Глобальные переменные: a, m, c, xcur.

\begin{algorithm}[H]
\DontPrintSemicolon
\SetAlgoLined
\SetKwInOut{Input}{Input}\SetKwInOut{Output}{Output}
\Input{}
\Output{x - равномерно распределенное случайное число из (0, 1)}

\BlankLine

x = (xcur * a + c) mod m\;

xcur = x;

return x / m;

\caption{Get random}
\end{algorithm}

### Генерация координат следующей частицы

\begin{algorithm}[H]
\DontPrintSemicolon
\SetAlgoLined
\SetKwInOut{Input}{Input}\SetKwInOut{Output}{Output}
\Input{x', y', r - координаты центра и радиус текущего агрегата}
\Output{x, y - координаты новой частицы}

\BlankLine

r = r + 10;

angle = 2*PI * random();

x = r * cos(angle) + x';

y = r * sin(angle) + y';

return x, y;

\caption{Get next particular}
\end{algorithm}

### Блуждание частицы

\begin{algorithm}[H]
\DontPrintSemicolon
\SetAlgoLined
\SetKwInOut{Input}{Input}\SetKwInOut{Output}{Output}
\Input{x, y,  ref X, ref Y, x', y', r - координаты текущей частицы, координаты кластера, координаты центра, радиус }
\Output{Добавление координат в X, Y}

\BlankLine

step = 1; dx = [1, -1, 0, 0]; dy = [0, 0, 1, -1];

\While{step < 500 and (xl - x  > r or x - xr > r or y - yu > r or yd - y > r}{

\If{частица оказалась по соседству с кластером}{
        X.append(x); Y.append(y);

​		return; }

i = ceil(100*random()) mod 4;

x += dx[i]; y += dy[i]; step++; }

\caption{Random walk}
\end{algorithm}

### Псевдокод модели DLA

\begin{algorithm}[H]
\DontPrintSemicolon
\SetAlgoLined
\SetKwInOut{Input}{Input}\SetKwInOut{Output}{Output}
\Input{x0, y0, t - координаты первой частицы, количество итераций}
\Output{X, Y - координаты частиц через время t}

\BlankLine

xl = x0; xr = x0; yu = y0;  yd = y0;

\For{i=1..t}{

​	r = sqrt(pow((xr - xl), 2) + pow((yu - yd), 2))/2;

​	x, y = Get next particular((xr - xl)/2, (yu-yd)/2, r);

​	Random walk(x, y, X, Y, x0, y0, sqrt(pow((xr - xl), 2) + pow((yu - yd), 2))/2);

}

return X, Y;

\caption{DLA}
\end{algorithm}

### Фрактальная размерность

\begin{algorithm}[H]
\DontPrintSemicolon
\SetAlgoLined
\SetKwInOut{Input}{Input}\SetKwInOut{Output}{Output}
\Input{X, Y, cnt, maxR - координаты частиц агрегата, количество сфер, максимальный радиус}
\Output{d - фрактальная размерность}

\BlankLine

d = -1

\For{i=1..cnt}{

​	r = random()*maxR;

​	m = количество частиц кластера внутри i-той сферы;

​	newD = ln(m) / ln(r);

\If{not(d == -1 or abs(d - newD) < 1e-10)}{

​	return -1;

}

return d;

}

\caption{Fractal uniformity}
\end{algorithm}

## Другие модели

- **Бессеточная**: добавляется выбор случайной длины шага.
- **Химически-ограниченная**: вводится условие прилипания.
- **Баллистическая**: метод случаного блуждания изменяется на прямолинейную траекторию

# Выводы

- Рассмотренные алгоритмы позволяют построить комплексы программ для вычислительных экспериментов.

# Список литературы{.unnumbered}

::: {#refs}
:::
